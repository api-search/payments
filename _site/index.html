<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>APIs.io - Payments - Search</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand" href="#">APIs.io - Payments</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="http://localhost:4000/">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="http://localhost:4000/apis/">APIs</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="http://localhost:4000/tags/">Tags</a>
            </li>   
            <li class="nav-item">
              <a class="nav-link" href="http://localhost:4000/rules/">Rules</a>
            </li>   
            <li class="nav-item">
              <a class="nav-link" href="http://localhost:4000/properties/">Properties</a>
            </li>                                    
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Network
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="#">Artificial Intelligence</a></li>
                <li><a class="dropdown-item" href="#">Banking</a></li>
                <li><a class="dropdown-item" href="#">Cloud</a></li>
                <li><a class="dropdown-item" href="#">Code</a></li>                
                <li><a class="dropdown-item" href="#">Commerce</a></li>
                <li><a class="dropdown-item" href="#">Documents</a></li>     
                <li><a class="dropdown-item" href="#">Financial</a></li>              
                <li><a class="dropdown-item" href="#">Infrastructure</a></li>                             
                <li><a class="dropdown-item" href="#">Messaging</a></li>
                <li><a class="dropdown-item" href="#">Travel</a></li>
                <li><a class="dropdown-item" href="#">Videos</a></li>
              </ul>
            </li>
          </ul>
           
        </div>
      </div>
    </nav>

    <div class="container my-5">
      <center>
<p class="uk-text-lead uk-text-center" style="font-size: 24px; margin-bottom: 10px;">APIs.io - Payments Search Index</p>
<form class="row">
    <table align="center" style="width: 250px;">
        <tr>
            <td style="width: 350px;" align="right">
                <input type="text" class="form-control" id="api-search" style="width: 250px">
            </td>
            <td style="width: 50px;" align="center">
                <input type="text" class="form-control" id="api-limit" style="width: 50px" value="10">
            </td>                                
            <td style="width: 50px;">
                <button type="submit" class="btn btn-dark" onclick="search(); return false;">Search</button>
            </td>
        </tr>
    </table>
</form>
</center>
<table  class="table table-hover" id="search-results"></table>    
     
<script>     

    function searchNode(node_url){

        const options = {
                method: 'get',
                headers: {
                    "Accept": "application/json"
                }
            };	

        fetch(node_url,options)
            .then(function(response) {
                if (!response.ok) {
                    console.log('Error with Status Code: ' + response.status);
                    return;
                }
                response.json().then(function(search) {	
                
                    if(prime == 0){
                        
                        let rows = '';
                        if(search.data.length > 0){
                            for (let i = 1; i < search.data.length; i++) {

                                console.log(search.data[i].name);

                                var query_search = query.toLowerCase();
                                var name_search = search.data[i].name.toLowerCase();
                                var description_search = search.data[i].description.toLowerCase();

                                var name_match = name_search.includes(query_search);
                                var description_match = description_search.includes(query_search);

                                var tag_match = false;
                                for (let j = 1; j < search.data[i].tags.length; j++) {
                                    //console.log(search.data[i].tags[j]);
                                    var tag_search = search.data[i].tags[j].toLowerCase();                                                       
                                    tag_match = tag_search.includes(query_search);                                    
                                }

                                //console.log(query_search);
                                //console.log(search.data[i].name);
                                //console.log(name_match);
                                //console.log(description_match);
                                //console.log(tag_match);

                                if(name_match == true || description_match == true || tag_match == true){

                                    rows += '<tr>';
                                    rows += '<th scope="row"></th>';
                                    rows += '<td style="text-align:left; vertical-align: middle;">' + search.data[i].name + '</td>';
                                    rows += '<td style="width: 50px;"><a href="' + search.data[i].humanURL + '" target="_blank"><button type="button" class="btn btn-outline-primary">API</button></a></td>';
                                    rows += '<td style="width: 50px;"><a href="apis/' + search.data[i].slug + '/apis/" target="_blank"><button type="button" class="btn btn-outline-success">INFO</button></a></td>';
                                    rows += '</tr>';

                                }

                            }
                            document.getElementById('search-results').innerHTML = rows;
                        }
                        else{
                            document.getElementById('search-results').innerHTML = '<tr><th scope="row"></th><td style="padding: 25px;">No Results</td></tr>';
                        }
                        
                        
                    }
                });
            })
            .catch(function(err) {
                console.log('Error: ' + err);
        }); 

    }

    function search(){

        let query = 'api';
        let prime = 1;
        if(document.getElementById('api-search').value != ''){                        
            query = document.getElementById('api-search').value;
            prime = 0;
        }

        let limit = document.getElementById('api-limit').value;
        if(limit == ''){ limit = 10; }

        // Search Local
        searchNode('api/index.json');

        
        
            
        // Search Network
        searchNode('https://ai.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://banking.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://cloud.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://code.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://commerce.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://documents.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://financial.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://infrastructure.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://messaging.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://payments.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://travel.apis.io/apis.json');

        
            
        // Search Network
        searchNode('https://videos.apis.io/apis.json');

                 
              
    }
</script>
                    

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  </body>
</html>